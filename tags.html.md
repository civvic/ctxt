# tags


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

<!-- # Prologue -->

# Tag Discovery

------------------------------------------------------------------------

<a href="https://github.com/civvic/ctxt/blob/main/ctxt/tags.py#L23"
target="_blank" style="float:right; font-size:smaller">source</a>

### discover_tags

>  discover_tags (text:str)

*Find all <Tag> patterns in text*

``` python
text = "Hello <User-Name>, welcome to <Project-Name>!"
tags = discover_tags(text)
test_eq(tags, {'User-Name', 'Project-Name'})

test_eq(discover_tags("No tags here"), set())

text_dup = "<Tag1> and <Tag2> and <Tag1> again"
test_eq(discover_tags(text_dup), {'Tag1', 'Tag2'})
```

------------------------------------------------------------------------

<a href="https://github.com/civvic/ctxt/blob/main/ctxt/tags.py#L28"
target="_blank" style="float:right; font-size:smaller">source</a>

### discover_tags_in_file

>  discover_tags_in_file (path:str|pathlib.Path)

*Find all tags in a file, return empty set on error*

``` python
template_file = Path('../templates/Cursor/project.mdc')
if template_file.exists():
    tags_in_file = discover_tags_in_file(template_file)
    test_is('Project-Name' in tags_in_file, True)
    test_is('Project-Objective' in tags_in_file, True)
```

------------------------------------------------------------------------

<a href="https://github.com/civvic/ctxt/blob/main/ctxt/tags.py#L37"
target="_blank" style="float:right; font-size:smaller">source</a>

### discover_tags_in_templates

>  discover_tags_in_templates (template_dir:str|pathlib.Path,
>                                  extensions:list[str]|None=None)

*Discover all tags in template files Returns dict mapping file paths to
sets of tags found in each file*

``` python
# Test discover_tags_in_templates
templates_dir = Path('../templates')
if templates_dir.exists():
    all_tags = discover_tags_in_templates(templates_dir)
    test_is(len(all_tags) > 0, True)  # Should find some files with tags
    test_is(isinstance(all_tags, dict), True)
```

# Tag Substitution

------------------------------------------------------------------------

<a href="https://github.com/civvic/ctxt/blob/main/ctxt/tags.py#L58"
target="_blank" style="float:right; font-size:smaller">source</a>

### substitute_tags

>  substitute_tags (text:str, tags:dict[str,str], max_depth:int=10,
>                       warn_missing:bool=False)

*Recursively substitute tags in text*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>text</td>
<td>str</td>
<td></td>
<td>Text containing tags to substitute</td>
</tr>
<tr>
<td>tags</td>
<td>dict</td>
<td></td>
<td>Dictionary mapping tag names to values</td>
</tr>
<tr>
<td>max_depth</td>
<td>int</td>
<td>10</td>
<td>Maximum recursion depth for nested tags</td>
</tr>
<tr>
<td>warn_missing</td>
<td>bool</td>
<td>False</td>
<td>If True, print warnings for missing tags</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>str</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

``` python
text = "Hello <User-Name>, welcome to <Project-Name>!"
tags = {'User-Name': 'Vic', 'Project-Name': 'ctxt'}
result = substitute_tags(text, tags)
test_eq(result, "Hello Vic, welcome to ctxt!")

tags_nested = {
    'Name': 'Vic',
    'Greeting': 'Hello <Name>',
    'Message': '<Greeting>, welcome!'
}
result = substitute_tags('<Message>', tags_nested)
test_eq(result, 'Hello Vic, welcome!')

text = "Hello <Missing-Tag>"
result = substitute_tags(text, {})
test_eq(result, "Hello <Missing-Tag>")  # Should leave as-is
```

``` python
# Test recursion limit protection
circular_tags = {
    'A': 'Value with <B>',
    'B': 'Value with <A>'
}
test_eq(substitute_tags('<A>', circular_tags, max_depth=5), 'Value with Value with Value with Value with Value with <B>')
```

    Warning: Max recursion depth (5) reached. Unresolved tags: {'B'}

------------------------------------------------------------------------

<a href="https://github.com/civvic/ctxt/blob/main/ctxt/tags.py#L93"
target="_blank" style="float:right; font-size:smaller">source</a>

### substitute_tags_in_file

>  substitute_tags_in_file (src:str|pathlib.Path, dst:str|pathlib.Path,
>                               tags:dict[str,str], **options)

*Process file with tag substitution and write to destination*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>src</td>
<td>str | pathlib.Path</td>
<td>Source file path</td>
</tr>
<tr>
<td>dst</td>
<td>str | pathlib.Path</td>
<td>Destination file path</td>
</tr>
<tr>
<td>tags</td>
<td>dict</td>
<td>Dictionary mapping tag names to values</td>
</tr>
<tr>
<td>options</td>
<td>VAR_KEYWORD</td>
<td></td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td><strong>Additional options for substitute_tags (strict, max_depth,
warn_missing)</strong></td>
</tr>
</tbody>
</table>

``` python
# Create a temp file with tags
try:
    with tempfile.NamedTemporaryFile(suffix='.txt', delete_on_close=False) as tmp_src:
        tmp_src_path = Path(tmp_src.name)
        tmp_src_path.write_text("Project: <Project-Name>\nUser: <User-Name>")

        with tempfile.NamedTemporaryFile(mode='w', suffix='.txt', delete=False) as tmp_dst:
            tmp_dst_path = Path(tmp_dst.name)
            tags = {'Project-Name': 'TestProject', 'User-Name': 'TestUser'}
            substitute_tags_in_file(tmp_src_path, tmp_dst_path, tags)
            test_eq(tmp_dst_path.read_text(), "Project: TestProject\nUser: TestUser")
finally:
    if tmp_src_path.exists(): tmp_src_path.unlink()
    if tmp_dst_path.exists(): tmp_dst_path.unlink()
```

------------------------------------------------------------------------

<!-- # Colophon -->
